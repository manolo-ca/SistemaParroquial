<div class="ui-g ui-fluid" style="background-color: whitesmoke;">
   
    <form #compraform="ngForm">
      
        <br><br>
        <div class="ui-g-12 ui-lg-12">
            <div class="ui-g-12 ui-md-1">
                <label for="input">Fecha de Emisión: </label>
            </div>
            <div class="ui-g-12 ui-md-2">
                <p-calendar [showIcon]="true" placeholder="Fecha Emision" size="35"
                    [(ngModel)]="compra.compFechaemision" name="FechaEmision" [locale]="es" dateFormat="yy-mm-dd">
                </p-calendar>
            </div>
            <div class="ui-g-12 ui-md-1">
                <label for="input">Nro. Doc: </label>
            </div>
            <div class="ui-g-12 ui-md-1">
                <input type="text" name="NroDocumento" [(ngModel)]="compra.compNumdocumento" pInputText required
                    #compNumDocumento="ngModel" placeholder="DOCUMENTO">
                <div *ngIf="compNumDocumento.invalid && compNumDocumento.touched">
                    <div *ngIf="compNumDocumento.errors.required">
                        <div class="alert alert-danger" role="alert">
                            ¡Ingrese el numero de documento!
                        </div>
                    </div>
                </div>
            </div>
            <div class="ui-g-12 ui-md-1">
                <label for="input">Nro. Aut: </label>
            </div>
            <div class="ui-g-12 ui-md-1">
                <input type="text" name="compraNumdocumento" [(ngModel)]="compra. compNumautorizacion" pInputText
                    required #numAutorizacion="ngModel" placeholder="AUTORIZACIÓN">
                <div *ngIf="numAutorizacion.invalid && numAutorizacion.touched">
                    <div *ngIf="numAutorizacion.errors.required">
                        <div class="alert alert-danger" role="alert">
                            ¡Ingrese el numero de Autorizacion!
                        </div>
                    </div>
                </div>
            </div>
            <div class="ui-g-12 ui-md-1">
                <label for="input">Caja: </label>
            </div>
            <div class="ui-g-12 ui-md-4">
                <p-dropdown placeholder="Seleccione Caja..." (onChange)="cargarDatosCaja($event)" [showClear]="true"
                    [options]="cajas" optionLabel="cajaNombre"></p-dropdown>

            </div>


        </div>
        <div class="ui-g-12 ui-lg-12">
            <div class="card card-w-title">
                <div class="ui-g form-group">
                    <div class="ui-g form-group text-left">
                        <div class="ui-g-12 ui-md-1">
                            <label for="input"> CI ó RUC: </label>
                        </div>
                        <div class="ui-g-12 ui-md-3" *ngIf="proveedorpersona==false">
                            <p-autoComplete [suggestions]=proveedores (completeMethod)="autocompleteProveedor($event)"
                                placeholder="BUSQUEDA POR: NOMBRE ó CÉDULA ó RUC" [size]="30"
                                field="provFkPersona.persCedula" (onSelect)="cargarProveedor($event)">
                                <ng-template let-prov pTemplate="Proveedor">
                                    {{prov.provFkPersona.persCedula}} Proveedor: {{prov.provFkPersona.persApellido}}
                                    {{prov.provFkPersona.persNombre}}
                                </ng-template>
                            </p-autoComplete>
                        </div>
                        <div class="ui-g-12 ui-md-3" *ngIf="proveedorpersona==true">
                            <input disabled type="text" id="cedula" [(ngModel)]="persona.persCedula" name="persCedula"
                                pInputText readonly placeholder="CEDULA DEL PROVEEDOR">
                        </div>


                        <div class="ui-g-12 ui-md-1">
                            <label for="input">Proveedor: </label>
                        </div>
                        <div class="ui-g-12 ui-md-3">
                            <input disabled type="text" id="nombre" [(ngModel)]="persona.persNombre" name="persNombre"
                                pInputText readonly placeholder="NOMBRE DEL PROVEEDOR">
                        </div>
                        <div class="ui-g-12 ui-md-1">
                            <label for="input">Email: </label>
                        </div>
                        <div class="ui-g-12 ui-md-2">
                            <input disabled type="text" id="email" [(ngModel)]="persona.persEmail" name="persEmail"
                                pInputText readonly placeholder="EMAIL DEL PROVEEDOR">
                        </div>
                        <div class="ui-g-12 ui-md-1">
                            <p-button icon="pi pi-users" styleClass="ui-button-success" label=" "
                                (click)="gestionarProveedor()"> <br> </p-button>
                        </div>
                        <div class="ui-g-12 ui-md-1">
                            <label for="input">Teléfono: </label>
                        </div>
                        <div class="ui-g-12 ui-md-3">
                            <input disabled type="text" id="telefono" [(ngModel)]="persona.persTelefono"
                                name="persTelefono" pInputText readonly placeholder="TÉLEFONO DEL PROVEEDOR">
                        </div>
                        <div class="ui-g-12 ui-md-1">
                            <label for="input">Dirección: </label>
                        </div>
                        <div class="ui-g-12 ui-md-7">
                            <input disabled type="text" class="form-control border-secondary" id="direccion"
                                [(ngModel)]="persona.persDireccion" name="persDireccion" pInputText readonly
                                placeholder="DIRECCIÓN DEL PROVEEDOR">
                        </div>
                        <div class="ui-g-12 ui-md-1">
                            <label for="input">Descripcion: </label>
                        </div>
                        <div class="ui-g-12 ui-md-11">
                            <input required type="text" class="form-control border-secondary" id="descripcion"
                                [(ngModel)]="cajamovimiento.cajmObservaciones" name="descripcion" pInputText
                                #cajmObservaciones="ngModel" placeholder="DESCRIPCION">
                            <div *ngIf="cajmObservaciones.invalid && cajmObservaciones.touched">
                                <div *ngIf="cajmObservaciones.errors.required">
                                    <div class="alert alert-danger" role="alert">
                                        ¡Ingrese una breve descripcion de la compra!
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="card">
            <div>
                <div class="ui-g-12 ui-lg-12">
                    <div class="p-grid" style="margin: 5px; background-color: whitesmoke;">
                        <div class="p-col text-center">
                            <div class="ui-g-12 ui-md-3" *ngIf="almacen.almaVenta==true">
                                <p-button icon="pi pi-plus" styleClass="ui-button-success" label=" Crear Productos"
                                    (click)="gestionarProducto()"></p-button>
                                    <span></span>
                            </div>
                            <div class="ui-g-12 ui-md-1">
                                <label for="input">Bodega: </label>
                            </div>
                            <div class="ui-g-12 ui-md-6">
                                <p-dropdown [options]="almacenes" placeholder="Seleccione Almacen..."
                                    optionLabel="almaNombre" (onChange)="cargarAlmacen($event)"></p-dropdown>
                            </div>

                            <div *ngIf="almacen.almaVenta==true" class="ui-g-12 ui-md-2">
                                <p-button icon="pi pi-list" styleClass="ui-button-info" label=" Agregar Productos"
                                    (click)="cargarProductoVentana()"></p-button>

                            </div>
                            <!-- 
                            <div *ngIf="almacen.almaVenta==false" class="ui-g-12 ui-md-2">
                                <p-button icon="pi pi-list" styleClass="ui-button-info" label="Agregar Inventarios"
                                    (click)="cargarInventarioVentana()"></p-button>
                            </div>-->

                        </div>

                    </div>
                </div>

                <div class="table-responsive">
                    <table class="table table-striped my-3">
                        <thead>
                            <tr>
                                <th scope="col">Codigo</th>
                                <th scope="col">Descripcion</th>
                                <th scope="col">Cantidad</th>
                                <th scope="col">Nro Existencias</th>
                                <th scope="col">Precio Unitario</th>
                                <th scope="col">Subtotal</th>
                                <th scope="col">IVA</th>
                                <th scope="col">Acciones</th>
                            </tr>
                        </thead>
                        <tbody *ngIf="almacen.almaVenta==true">
                            <tr *ngFor="let item of compra.detalleCompraCollection">
                                <td>{{item.producto.prodId}}</td>
                                <td>{{item.producto.prodNombre}}</td>
                                <td>
                                    <div></div><input type="text" name="cantidad[]" class="col-sm-4" id="cantidad"
                                        value="{{item.detcCantidad}}"
                                        (change)="actualizarCantidad(item.producto.prodId,$event)">
                                </td>
                                <td>{{item.producto.prodCantidad}}</td>
                                <td>{{item.producto.prodPrecio}}</td>
                                <td>{{item.calcularTotalProducto()}}</td>
                                <td>{{item.calcularIvaIndividual(item.detcCantidad)}}</td>
                                <td>
                                    <p-button icon="pi pi-trash" styleClass="ui-button-danger col-sm-4"
                                        (onClick)="eliminarDetalle(item.producto.prodId)"></p-button>
                                </td>
                            </tr>
                        </tbody>
                        <tbody *ngIf="almacen.almaVenta==false">
                            <tr *ngFor="let item of compra.detalleCompraCollection">
                                <td>{{item.inventario.inveId}}</td>
                                <td>{{item.inventario.inveNombre}}</td>
                                <td>
                                    <div></div><input type="text" name="cantidad[]" class="col-sm-4" id="cantidad"
                                        value="{{item.detcCantidad}}"
                                        (change)="actualizarCantidadInventario(item.inventario.inveId,$event)">
                                </td>
                                <td>{{item.inventario.inveCantidad}}</td>
                                <td>{{item.inventario.invePrecio}}</td>
                                <td>{{item.calcularTotalInventario()}}</td>
                                <td>
                                    <p-button icon="pi pi-trash" styleClass="ui-button-danger col-sm-4"
                                        (onClick)="eliminarDetalleInventario(item.inventario.inveId)"></p-button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div *ngIf="almacen.almaVenta==true" class="float-right">
                    <table class="table" style="font-weight: bold; font-size: 20px;">
                        <tr hidden>
                            <td>Subtotal sin Impuesto:</td>
                            <td class="ml-4">0.00</td>
                        </tr>
                        <tr >
                            <td class="text-right">Total IVA 0%:</td>
                            <td class="ml-4">0.00</td>
                        </tr>
                        <tr>
                            <td class="text-right">Subtotal:</td>
                            <td class="ml-4">{{compra.calcularSubTotal()}}{{compra.compSubtotal.toFixed(2)}}</td>
                        </tr>
                        <tr>
                            <td class="text-right">Descuento:</td>
                            <td class="ml-4">0.00</td>
                        </tr>
                        <tr>
                            <td class="text-right">Total IVA 12%:</td>
                            <td ng-model='val | number: 2' class="ml-4">{{compra.calcularIva()}}{{compra.compTotalIva.toFixed(2)}}
                            </td>
                        </tr>
                        <tr>
                            <td class="text-right">Total:</td>
                            <td ng-model='val | number: 2' class="ml-4" style="color: red; font-size: 30px;">
                                {{compra.calcularTotales()}}{{compra.compTotal.toFixed(2)}}</td>
                        </tr>
                    </table>

                    <div class="text-center">
                        <div *ngIf="validaboton==true">
                            <p-button label="Guardar Compra" (click)="crearCompra(compraform)" icon="pi pi-save"
                                styleClass="ui-button-info"></p-button>
                        </div>
                        <div>
                            <p-button hidden label="Imprimir" icon="pi pi-print" styleClass="ui-button-success">
                            </p-button>
                        </div>
                    </div>
                </div>

                <div *ngIf="almacen.almaVenta==false" class="float-right">
                    <table class="table">
                        <tr hidden>
                            <td>Subtotal sin Impuesto:</td>
                            <td class="ml-4">0.00</td>
                        </tr>
                        <tr hidden>
                            <td class="text-right">Subtotal 12%:</td>
                            <td class="ml-4">0.00</td>
                        </tr>
                        <tr>
                            <td class="text-right">Subtotal:</td>
                            <td class="ml-4"> {{compra.calcularSubTotalInventario()}}{{compra.compSubtotal}}</td>
                        </tr>
                        <tr>
                            <td class="text-right">Descuento:</td>
                            <td class="ml-4">0.00</td>
                        </tr>
                        <tr>
                            <td class="text-right">IVA:</td>
                            <td class="ml-4">{{compra.calcularIvaInventario()}}{{compra.compTotalIva}}</td>
                        </tr>
                        <tr>
                            <td class="text-right">Total:</td>
                            <td class="ml-4">{{compra.calcularTotalesInventario()}}{{compra.compTotal}}</td>
                        </tr>
                    </table>
                    <div class="text-center" *ngIf="validaboton==true">
                        <p-button label="Guardar Compra" (click)="crearCompra(compraform)" icon="pi pi-save"
                            styleClass="ui-button-info"></p-button>
                    </div>
                    <div>
                        <p-button hidden label="Imprimir" icon="pi pi-print" styleClass="ui-button-success">
                        </p-button>
                    </div>
                </div>

            </div>
        </div>

    </form>
</div>

<p-dialog header="GESTÓN DE PRODUCTOS" [(visible)]="disa" [modal]="true" [style]="{width: '80vw'}" [maximizable]="true"
    [baseZIndex]="10000" [draggable]="false" [resizable]="false">
    <div class="container">
        <p-scrollPanel [style]="{width: '100%', height: '500px'}">

            <div class="card">
                <form [formGroup]="addForm1">
                    <div class="ui-g ui-fluid">
                        <div class="ui-g form-group ">
                            <div class="ui-g-12 ui-md-2">
                                <p><strong>Proveedor: </strong></p>
                            </div>
                            <div class="ui-g-12 ui-md-4">
                                <p-dropdown id="prodFkProveedor" name="prodFkProveedor"
                                    formControlName="prodFkProveedor" [options]="proveedores2"
                                    [(ngModel)]="producto2.prodFkProveedor" [filter]="true"
                                    optionLabel="provFkPersona.persNombre"></p-dropdown>
                                <small class="p-error" style="color: red;"
                                    *ngIf="submitted && f.prodFkProveedor.errors && f.prodFkProveedor.errors.required">Campo
                                    requerido</small>
                            </div>
                            <br>
                            <div class="ui-g-12 ui-md-2">
                                <p><strong>Almacen: </strong></p>
                            </div>
                            <div class="ui-g-12 ui-md-4">
                                <p-dropdown id="prodFkAlmacen" name="prodFkAlmacen" formControlName="prodFkAlmacen"
                                    [options]="almacenes" [(ngModel)]="producto2.prodFkAlmacen" [filter]="true"
                                    optionLabel="almaNombre">
                                </p-dropdown>
                                <small class="p-error" style="color: red;"
                                    *ngIf="submitted && f.prodFkAlmacen.errors && f.prodFkAlmacen.errors.required">Campo
                                    requerido</small>
                            </div>
                            <br>
                            <div class="ui-g-12 ui-md-2">
                                <p><strong>Nombre: </strong></p>
                            </div>
                            <div class="ui-g-12 ui-md-4">
                                <input maxlength="250" class="input nombre" type="text" formControlName="prodNombre"
                                    name="prodNombre" id="prodNombre" pInputText placeholder="Nombre"
                                    class="form-control" [(ngModel)]="producto2.prodNombre">
                                <small class="p-error" style="color: red;"
                                    *ngIf="submitted && f.prodNombre.errors && f.prodNombre.errors.required">Campo
                                    requerido</small>
                            </div>
                            <br>
                            <div class="ui-g-12 ui-md-2">
                                <p><strong>Categoria: </strong></p>
                            </div>
                            <div class="ui-g-12 ui-md-4">
                                <input maxlength="250" class="input nombre" type="text" formControlName="prodCategoria"
                                    name="prodCategoria" id="prodCategoria" pInputText placeholder="Categoria"
                                    class="form-control" [(ngModel)]="producto2.prodCategoria">
                                <small class="p-error" style="color: red;"
                                    *ngIf="submitted && f.prodCategoria.errors && f.prodCategoria.errors.required">Campo
                                    requerido</small>
                            </div>
                            <br>
                            <div class="ui-g-12 ui-md-2">
                                <p><strong>Iva: </strong></p>
                            </div>
                            <div class="ui-g-12 ui-md-4">
                                <p-checkbox [(ngModel)]="producto2.prodIva" binary="true" formControlName="prodIva"
                                    name="prodIva" id="prodIva"></p-checkbox>
                            </div>
                            <br>
                            <div class="ui-g-12 ui-md-2">
                                <p><strong>Detalle: </strong></p>
                            </div>
                            <div class="ui-g-12 ui-md-4">
                                <input maxlength="250" class="input detalle" type="text" formControlName="prodDetalle"
                                    name="prodDetalle" id="prodDetalle" pInputText placeholder="Detalle"
                                    class="form-control" [(ngModel)]="producto2.prodDetalle">
                                <small class="p-error" style="color: red;"
                                    *ngIf="submitted && f.prodDetalle.errors && f.prodDetalle.errors.required">Campo
                                    requerido</small>
                            </div>
                            <br>
                            <div class="ui-g-12 ui-md-2">
                                <p><strong>Cantidad: </strong></p>
                            </div>
                            <div class="ui-g-12 ui-md-4">
                                <input maxlength="250" class="input  cantidad" type="number" pKeyFilter="int"
                                    formControlName="prodCantidad" name="prodCantidad" id="prodCantidad" pInputText
                                    placeholder="Cantidad" class="form-control" [(ngModel)]="producto2.prodCantidad">
                                <small class="p-error" style="color: red;"
                                    *ngIf="submitted && f.prodCantidad.errors && f.prodCantidad.errors.required">Campo
                                    requerido</small>
                            </div>
                            <br>
                            <div class="ui-g-12 ui-md-2">
                                <p><strong>Precio: </strong></p>
                            </div>
                            <div class="ui-g-12 ui-md-4">
                                <input maxlength="250" class="input precio" type="number" pKeyFilter="money"
                                    formControlName="prodPrecio" name="prodPrecio" id="prodPrecio" pInputText
                                    placeholder="Precio" class="form-control" [(ngModel)]="producto2.prodPrecio">
                                <small class="p-error" style="color: red;"
                                    *ngIf="submitted && f.prodPrecio.errors && f.prodPrecio.errors.required">Campo
                                    requerido</small>
                            </div>
                            <br>
                            <div class="ui-g-12">
                                <p-button icon="pi pi-save" stileClass="ui-button-info" label="Guardar"
                                    (click)='crearProducto()' *ngIf="!producto2.prodId else elseBlockP"></p-button>
                                <ng-template #elseBlockP>
                                    <button class="btn btn-primary" role="button" (click)='editarProducto()'>Editar</button>
                                    <button class="btn btn-danger" role="button" (click)='cancelar()'>Cancelar</button>
                                </ng-template>
                            </div>

                        </div>
                    </div>
                </form>
            </div>
            <div class="card">
                <p-table #dt [value]="productos2" dataKey="prodId" [paginator]="true" [columns]="cols" [rows]="10"
                    [showCurrentPageReport]="true" [rowsPerPageOptions]="[10,25,50]" [loading]="loading"
                    styleClass="p-datatable-customers p-datatable-gridlines" [paginator]="true"
                    currentPageReportTemplate="Lista de Productos" [globalFilterFields]="['prodNombre']">
                    <ng-template pTemplate="caption">
                        <div class="p-grid">
                            <div class="p-col" style="text-align: left;">
                                <h3>Lista de Productos</h3>
                            </div>
                            <div class="p-col" style="text-align: right">
                                <i class="pi pi-search" style="margin:4px 4px 0 0"></i>
                                <input type="text" pInputText size="50" placeholder="Nombre del Producto"
                                    style="width:auto" (input)="dt.filterGlobal($event.target.value, 'contains')">
                            </div>
                        </div>
                    </ng-template>
                    <ng-template pTemplate="header">
                        <tr class="text-center" style="font-size: smaller;">
                            <!-- <th style="width: 80px;">ID</th> -->
                            <th>Nombre</th>
                            <th style="width: 80px;">Cantidad</th>
                            <th style="width: 80px;">Precio</th>
                            <th>Detalle</th>
                            <th>Proveedor</th>
                            <th>Almacen</th>
                            <th>Categoria</th>
                            <th style="width: 80px;">Iva</th>
                            <th style="width: 100px;">Acciones</th>
                        </tr>
                    </ng-template>
                    <ng-template pTemplate="body" let-productos2>
                        <tr>
                            <!-- <td>{{productos.prodId}}</td> -->
                            <td>{{productos2.prodNombre}}</td>
                            <td style="width: 80px;">{{productos2.prodCantidad}}</td>
                            <td style="width: 80px;">{{productos2.prodPrecio}}</td>
                            <td>{{productos2.prodDetalle}}</td>
                            <td>{{productos2.prodFkProveedor.provFkPersona.persNombre}}
                                {{productos2.prodFkProveedor.provFkPersona.persApellido}}</td>
                            <td>{{productos2.prodFkAlmacen.almaNombre}}</td>
                            <td>{{productos2.prodCategoria}}</td>
                            <td class="text-center" *ngIf="productos2.prodIva == false">
                                <p-message severity="error" text="Sin IVA"></p-message>
                            </td>
                            <td class="text-center" *ngIf="productos2.prodIva == true">
                                <p-message severity="success" text="IVA"></p-message>
                            </td>


                            <td style="width: 100px;" class="text-center">
                                <p-button icon="pi pi-pencil" (click)="preparedit(productos2)"
                                    styleClass="ui-button-warning">
                                </p-button>
                                <p-button icon="pi pi-trash" (click)="eliminar(productos2)"
                                    styleClass="ui-button-danger">
                                </p-button>
                            </td>
                        </tr>
                    </ng-template>
                    <ng-template pTemplate="emptymessage">
                        <tr>
                            <td>No hay datos.</td>
                        </tr>
                    </ng-template>
                </p-table>

            </div>

        </p-scrollPanel>
    </div>
    <p-footer>
        <div class="p-grid">
            <div class="p-col text-right">
                <p-button icon="pi pi-times" (click)="disa=false" label="Cerrar" styleClass="ui-button-secondary">
                </p-button>
            </div>
        </div>
    </p-footer>
</p-dialog>

<p-dialog header="GESTÓN DE INVENTARIO" [(visible)]="disa2" [modal]="true" [style]="{width: '80vw'}"
    [maximizable]="true" [baseZIndex]="10000" [draggable]="false" [resizable]="false">
    <p-scrollPanel styleClass="custombar1">
        <app-inventario></app-inventario>
    </p-scrollPanel>
    <p-footer>
        <div class="p-grid">
            <div class="p-col text-right">
                <p-button icon="pi pi-times" (click)="disa2=false" label="Cerrar" styleClass="ui-button-secondary">
                </p-button>
            </div>
        </div>
    </p-footer>
</p-dialog>

<p-dialog header="GESTÓN DE PROVEEDOR" [(visible)]="disa3" [modal]="true" [style]="{width: '80vw'}" [maximizable]="true"
    [baseZIndex]="10000" [draggable]="false" [resizable]="false">
    <p-scrollPanel [style]="{width: '100%', height: '500px'}">
        <div class="card card-w-title">
            <h1>Proveedores</h1>
            <div class="p-grid" style="margin: 5px; background-color: whitesmoke;">
                <div class="p-col">
                    <button icon="pi pi-plus" pButton type="button" (click)="showDialog()" label="Agregar"
                        class="ui-button-success"></button>
                </div>

            </div>
            <p-table #dt [value]="proveedores2" [paginator]="true" [columns]="cols" [rows]="10"
                [showCurrentPageReport]="true" [rowsPerPageOptions]="[10,25,50]" [loading]="loading"
                styleClass="p-datatable-customers p-datatable-gridlines" [paginator]="true"
                currentPageReportTemplate="Lista de Proveedores" [globalFilterFields]="['provFkPersona.persNombre']">
                <ng-template pTemplate="caption">
                    <div class="p-grid">
                        <div class="p-col" style="text-align: left;">
                            <h3>Lista de Proveedores</h3>
                        </div>
                        <div class="p-col" style="text-align: right">
                            <i class="pi pi-search" style="margin:4px 4px 0 0"></i>
                            <input type="text" pInputText size="50" placeholder="Nombre del Proveedor"
                                (input)="dt.filterGlobal($event.target.value, 'contains')" style="width:auto">
                        </div>
                    </div>
                </ng-template>
                <ng-template pTemplate="header" let-columns>
                    <tr>
                        <th>Cédula</th>
                        <th>Nombres</th>
                        <th>Apellidos</th>
                        <th>Email</th>
                        <th>Telefono</th>
                        <th>Dirección</th>
                        <th style="width: 100px;">Acciones</th>
                    </tr>
                </ng-template>
                <ng-template pTemplate="body" let-proveedor>
                    <tr>
                        <td>{{proveedor.provFkPersona.persCedula}}</td>
                        <td>{{proveedor.provFkPersona.persNombre}}</td>
                        <td>{{proveedor.provFkPersona.persApellido}}</td>
                        <td>{{proveedor.provFkPersona.persEmail}}</td>
                        <td>{{proveedor.provFkPersona.persTelefono}}</td>
                        <td>{{proveedor.provFkPersona.persDireccion}}</td>
                        <td style="width: 100px;" class="text-center">
                            <div class="row">
                                <!-- //<p-button icon="pi pi-pencil" styleClass="ui-button-warning"(click)="showDialogEdit(proveedores)"></p-button> -->
                                <p-button icon="pi pi-plus" (click)="seleccionarProveedor(proveedor)"></p-button>

                                <p-button icon="pi pi-trash" styleClass="ui-button-danger"
                                    (click)="eliminarProveedor(proveedor)"></p-button>
                                <p-button icon="pi pi-pencil" styleClass="ui-button-warning"
                                    (click)="editarProveedor(proveedor)"></p-button>
                            </div>
                        </td>
                    </tr>
                </ng-template>
                <ng-template pTemplate="emptymessage">
                    <tr>
                        <td colspan="1">No existen registros</td>
                    </tr>
                </ng-template>
            </p-table>
        </div>
    </p-scrollPanel>
    <p-footer>
        <div class="p-grid">
            <div class="p-col text-right">
                <p-button icon="pi pi-times" (click)="cerrarProveedor()" label="Cerrar" styleClass="ui-button-secondary">
                </p-button>
            </div>
        </div>
    </p-footer>
</p-dialog>

<p-dialog header="Ingresar nuevo Proveedor" [(visible)]="lista_personas" [modal]="true" [style]="{width: '80vw'}"
    [maximizable]="true" [baseZIndex]="10000" [draggable]="false" [resizable]="false">
    <p-scrollPanel [style]="{width: '100%', height: '500px'}">
        <form [formGroup]="addForm1">
            <div class="card">
                <p-table #dt1 [value]="personas" dataKey="persCedula" [rows]="10" [showCurrentPageReport]="true"
                    [rowsPerPageOptions]="[10,25,50]" [loading]="loading"
                    styleClass="p-datatable-customers p-datatable-gridlines" [showCurrentPageReport]="true"
                    [rowsPerPageOptions]="[10,25,50]" [loading]="loading"
                    styleClass="p-datatable-customers p-datatable-gridlines" [paginator]="true"
                    currentPageReportTemplate="lista de personas con documentos"
                    [globalFilterFields]="['persid','persCedula','persNombre','persApellido','persEmail','persTelefono','persDireccion']">
                    <ng-template pTemplate="caption">
                        <div class="p-d-flex">
                            <p>Usuarios Registrados</p>
                            <span class="p-input-icon-left p-ml-auto">
                                <i class="pi pi-search"></i>
                                <input pInputText type="text"
                                    (input)="dt1.filterGlobal($event.target.value, 'contains')" placeholder="Buscar" />
                            </span>
                        </div>
                    </ng-template>
                    <ng-template pTemplate="header">
                        <tr>
                            <th>Cédula</th>
                            <th>Nombres</th>
                            <th>Apellidos</th>
                            <th>Email</th>
                            <th>Telefono</th>
                            <th>Dirección</th>
                            <th>Acciones</th>
                        </tr>
                    </ng-template>
                    <ng-template pTemplate="body" let-person>
                        <tr>
                            <td>{{person.persCedula}}</td>
                            <td>{{person.persNombre}}</td>
                            <td>{{person.persApellido}}</td>
                            <td>{{person.persEmail}}</td>
                            <td>{{person.persTelefono}}</td>
                            <td>{{person.persDireccion}}</td>
                            <td>
                                <p-button label="Agregar" icon="pi pi-plus" class="p-button-success"
                                    (click)='guardarProveedor(person)'>
                                </p-button>

                            </td>
                        </tr>
                    </ng-template>
                    <ng-template pTemplate="emptymessage">
                        <tr>
                            <td colspan="7">No existen registros</td>
                        </tr>
                    </ng-template>
                </p-table>
            </div>

        </form>
    </p-scrollPanel>
    <p-footer>
        <button type="button" pButton icon="pi pi-plus" (click)="crearPersonasTemp()" label="Crear Persona"
            class="ui-button-primary"></button>
        <button type="button" pButton icon="pi pi-times" (click)="cerrarPersonas()" label="Cancelar"
            class="ui-button-secondary"></button>
            
    </p-footer>
</p-dialog>
<p-dialog header="EDICION DE PROVEEDOR" [(visible)]="editproveedor" [modal]="true" [style]="{width: '50vw'}"
    [maximizable]="true" [baseZIndex]="10000" [draggable]="false" [resizable]="false">
    <p-scrollPanel [style]="{width: '100%', height: '500px'}">
        <div class="card">
            <h1>Registro de Usuarios:</h1>
            <form [formGroup]="addForm3">
                <div class="ui-g ui-fluid">
                    <div class="ui-g form-group ">
                        <div class="ui-g-12 ui-lg-12 ">
                            <div class="ui-g-12 ui-md-3">
                                <label for="input">Cedula: </label>
                            </div>
                            <div class="ui-g-12 ui-md-9">
                                <div class="ui-inputgroup">
                                    <span class="ui-inputgroup-addon"><i class="pi pi-id-card"></i></span>
                                    <input maxlength="10" type="text" id="inse_cedula" name="inse_cedula"
                                        formControlName="inse_cedula" placeholder="Cedula" pInputText
                                        [(ngModel)]="persona.persCedula">
                                </div>
                            </div>
                            <div class="ui-g-12 ui-md-3">
                                <label for="input">Nombres: </label>
                            </div>
                            <div class="ui-g-12 ui-md-9">
                                <div class="ui-inputgroup">
                                    <span class="ui-inputgroup-addon"><i class="pi pi-user"></i></span>
                                    <input type="text" id="inse_nombre" name="inse_nombre" formControlName="inse_nombre"
                                        placeholder="Nombres" pInputText [(ngModel)]="persona.persNombre">
                                </div>
                            </div>
                            <div class="ui-g-12 ui-md-3">
                                <label for="input">Apellidos: </label>
                            </div>
                            <div class="ui-g-12 ui-md-9">
                                <div class="ui-inputgroup">
                                    <span class="ui-inputgroup-addon"><i class="pi pi-user"></i></span>
                                    <input type="text" id="inse_apellido" name="inse_apellido"
                                        formControlName="inse_apellido" placeholder="Apellidos" pInputText
                                        [(ngModel)]="persona.persApellido">
                                </div>
                            </div>
                            <div class="ui-g-12 ui-md-3">
                                <label for="input">Email: </label>
                            </div>
                            <div class="ui-g-12 ui-md-9">
                                <div class="ui-inputgroup">
                                    <span class="ui-inputgroup-addon"><i class=" pi pi-envelope"></i></span>
                                    <input type="email" id="inse_email" name="inse_email" formControlName="inse_email"
                                        placeholder="Email" pInputText [(ngModel)]="persona.persEmail">
                                </div>
                            </div>
                            <div class="ui-g-12 ui-md-3">
                                <label for="input">Telefono: </label>
                            </div>
                            <div class="ui-g-12 ui-md-9">
                                <div class="ui-inputgroup">
                                    <span class="ui-inputgroup-addon"><i class=" pi pi-mobile"></i></span>
                                    <input maxlength="10" type="text" id="inse_telefono" placeholder="Telefono"
                                        name="inse_telefono" formControlName="inse_telefono" pInputText
                                        [(ngModel)]="persona.persTelefono">
                                </div>
                            </div>
                            <div class="ui-g-12 ui-md-3">
                                <label for="input">Dirección: </label>
                            </div>
                            <div class="ui-g-12 ui-md-9">
                                <div class="ui-inputgroup">
                                    <span class="ui-inputgroup-addon"><i class=" pi pi-home"></i></span>
                                    <input type="text" id="inse_direccion" placeholder="Direccion" name="inse_direccion"
                                        formControlName="inse_direccion" pInputText [(ngModel)]="persona.persDireccion">
                                </div>
                            </div>
                        </div>

                        <div class="ui-g-12 ui-lg-12 text-center">
                            <p-button icon="pi pi-save" stileClass="ui-button-info" label="Guardar"
                            (click)='createPersona()' *ngIf="!persona.persid else elseBlock"></p-button>
                        <ng-template #elseBlock>
                            <button class="btn btn-primary" role="button" (click)='updateproveedor()'>Editar</button>
                        </ng-template>

                        </div>
                    </div>
                </div>
            </form>
        </div>
    </p-scrollPanel>
    <p-footer>
        <div class="p-grid">
            <div class="p-col text-right">
                <p-button icon="pi pi-times" (click)="cancelarEdision()" label="Cerrar"
                    styleClass="ui-button-secondary">
                </p-button>
            </div>
        </div>
    </p-footer>
</p-dialog>
<p-dialog header="PRODUCTOS BODEGA" [(visible)]="productosVentana" [modal]="true" [style]="{width: '80vw'}"
    [maximizable]="true" [baseZIndex]="10000" [draggable]="false" [resizable]="false">
    <p-scrollPanel [style]="{width: '100%', height: '500px'}">
        <div class="card">
            <p-table #dtProductos [value]="productos3" dataKey="prodId" [paginator]="true" [columns]="cols" [rows]="10"
                [showCurrentPageReport]="true" [rowsPerPageOptions]="[10,25,50]" [loading]="loading"
                styleClass="p-datatable-customers p-datatable-gridlines" [paginator]="true"
                currentPageReportTemplate="Lista de Productos" [globalFilterFields]="['prodNombre']">
                <ng-template pTemplate="caption">
                    <div class="p-grid">
                        <div class="p-col" style="text-align: left;">
                            <h3>Lista de Productos</h3>
                        </div>
                        <div class="p-col" style="text-align: right">
                            <i class="pi pi-search" style="margin:4px 4px 0 0"></i>
                            <input type="text" pInputText size="50" placeholder="Nombre del Producto" style="width:auto"
                                (input)="dtProductos.filterGlobal($event.target.value, 'contains')">
                        </div>
                    </div>
                </ng-template>
                <ng-template pTemplate="header">
                    <tr class="text-center" style="font-size: smaller;">
                        <!-- <th style="width: 80px;">ID</th> -->
                        <th>Nombre</th>
                        <th style="width: 80px;">Cantidad</th>
                        <th style="width: 80px;">Precio</th>
                        <th>Detalle</th>
                        <th>Proveedor</th>
                        <th>Almacen</th>
                        <th>Categoria</th>
                        <th style="width: 80px;">Iva</th>
                        <th style="width: 100px;">Acciones</th>
                    </tr>
                </ng-template>
                <ng-template pTemplate="body" let-productos3>
                    <tr>
                        <!-- <td>{{productos.prodId}}</td> -->
                        <td>{{productos3.prodNombre}}</td>
                        <td style="width: 80px;">{{productos3.prodCantidad}}</td>
                        <td style="width: 80px;">{{productos3.prodPrecio}}</td>
                        <td>{{productos3.prodDetalle}}</td>
                        <td>{{productos3.prodFkProveedor.provFkPersona.persNombre}}
                            {{productos3.prodFkProveedor.provFkPersona.persApellido}}</td>
                        <td>{{productos3.prodFkAlmacen.almaNombre}}</td>
                        <td>{{productos3.prodCategoria}}</td>
                        <td class="text-center" *ngIf="productos3.prodIva == false">
                            <p-message severity="error" text="Sin IVA"></p-message>
                        </td>
                        <td class="text-center" *ngIf="productos3.prodIva == true">
                            <p-message severity="success" text="IVA"></p-message>
                        </td>


                        <td >
                            <p-button icon="pi pi-shopping-cart" label="Agregar" (click)="agregarListaProducto(productos3)"
                                styleClass="ui-button-primary">
                            </p-button>
                        </td>
                    </tr>
                </ng-template>
                <ng-template pTemplate="emptymessage">
                    <tr>
                        <td>No hay datos.</td>
                    </tr>
                </ng-template>
            </p-table>

        </div>
    </p-scrollPanel>
    <p-footer>
        <div class="p-grid">
            <div class="p-col text-right">
                <p-button icon="pi pi-times" (click)="productosVentana=false" label="Cerrar"
                    styleClass="ui-button-secondary">
                </p-button>
            </div>
        </div>
    </p-footer>
</p-dialog>
<p-dialog header="INVENTARIO BODEGA" [(visible)]="inventarioVentana" [modal]="true" [style]="{width: '80vw'}"
    [maximizable]="true" [baseZIndex]="10000" [draggable]="false" [resizable]="false">
    <p-scrollPanel [style]="{width: '100%', height: '500px'}">
        <div class="card">
            <p-table #dtInventarios [value]="inventarioTemp" [paginator]="true" [rows]="10"
                [showCurrentPageReport]="true" [rowsPerPageOptions]="[10,25,50]" [loading]="loading"
                styleClass="p-datatable-customers p-datatable-gridlines" [paginator]="true"
                currentPageReportTemplate="Lista de Inventarios" [globalFilterFields]="['inveNombre']">
                <ng-template pTemplate="caption">
                    <div class="p-grid">
                        <div class="p-col" style="text-align: left;">
                            <h3>Lista de Inventario</h3>
                        </div>
                        <div class="p-col" style="text-align: right">
                            <i class="pi pi-search" style="margin:4px 4px 0 0"></i>
                            <input type="text" pInputText size="50" placeholder="Nombre del Articulo"
                                (input)="dtInventarios.filterGlobal($event.target.value, 'contains')"
                                style="width:auto">
                        </div>
                    </div>
                </ng-template>
                <ng-template pTemplate="header" let-columns>
                    <tr class="text-center" style="font-size: smaller;">
                        <th>Almacen</th>
                        <th>Activo</th>
                        <th>Nombre</th>
                        <th style="width: 80px;">Cantidad</th>
                        <th style="width: 80px;">Precio</th>
                        <th>Detalle</th>
                        <th style="width: 100px;">Acciones</th>
                    </tr>
                </ng-template>
                <ng-template pTemplate="body" let-inventarioTemp>
                    <tr class="text-center" style="font-size: smaller;">
                        <td>{{inventarioTemp.inveFkAlmacen.almaNombre}}</td>
                        <td>{{inventarioTemp.inveFkActivo.actiNombre}}</td>
                        <td>{{inventarioTemp.inveNombre}}</td>
                        <td style="width: 80px;">{{inventarioTemp.inveCantidad}}</td>
                        <td style="width: 80px;">{{inventarioTemp.invePrecio}}</td>
                        <td>{{inventarioTemp.inveDetalle}}</td>
                        <td class="text-center">
                            <p-button icon="pi pi-shopping-cart" (click)="agregarListaInventario(inventarioTemp)"
                                styleClass="ui-button-primary" label="Agregar">
                            </p-button>
                        </td>
                    </tr>
                </ng-template>
                <ng-template pTemplate="emptymessage">
                    <tr>
                        <td [attr.colspan]="'inventarioTemp.length'">No hay datos.</td>
                    </tr>
                </ng-template>
            </p-table>
        </div>
    </p-scrollPanel>
    <p-footer>
        <div class="p-grid">
            <div class="p-col text-right">
                <p-button icon="pi pi-times" (click)="disa2=false" label="Cerrar" styleClass="ui-button-secondary">
                </p-button>
            </div>
        </div>
    </p-footer>
</p-dialog>